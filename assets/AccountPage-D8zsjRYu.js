import{j as t,o as m,h as x,k as j,R as i,l as y,u as f,r as d,m as g,C as p}from"./index-DeZrwLwO.js";import{H as _}from"./Heading-BofQgKNY.js";import{a as C,b as N,S as M}from"./Favorites-SX_zxn4m.js";import{u as v}from"./useMutation-D8dKO91L.js";import{B as F}from"./Button-BEVKFRBe.js";import{S}from"./email-HFUIroiN.js";import{M as b}from"./MovieCardList-BJsFaBh1.js";import{N as A}from"./NotFound-CsLxKeFY.js";import"./ButtonLink-Bf0u306y.js";const u=({title:n,text:s,iconContent:e})=>t.jsxs("div",{className:"my-account-info",children:[t.jsx("div",{className:"my-account-info__icon",children:e}),t.jsxs("div",{className:"my-account-info__content",children:[t.jsx("span",{className:"my-account-info__title",children:n}),t.jsx("span",{className:"my-account-info__text",children:s})]})]}),k=m(()=>{const n=x(),s=j(),e=i.auth.user,o=v({mutationKey:["logout"],mutationFn:y,onSuccess(){s("/"),n.invalidateQueries({queryKey:["user"]})}});return e?t.jsxs("div",{className:"my-account-settings",children:[t.jsxs("div",{className:"my-account-settings__infos",children:[t.jsx(u,{title:"Имя Фамилия",text:`${e.name} ${e.surname}`,iconContent:(e.name[0]+e.surname[0]).toUpperCase()}),t.jsx(u,{title:"Электронная почта",text:e.email,iconContent:t.jsx(S,{"aria-hidden":!0,width:24,height:24})})]}),t.jsx(F,{onClick:()=>o.mutate(),loading:o.isPending,children:"Выйти из аккаунта"})]}):null}),q=()=>{var c,r;const n=f({queryKey:["movie","favorites"],queryFn:N}),s=v({mutationKey:["favorites","remove"],mutationFn:C}),e=((c=i.auth.user)==null?void 0:c.favorites)??[],o=(r=n.data)==null?void 0:r.filter(a=>e.includes(a.id.toString())),h=d.useCallback(a=>{s.mutate(a)},[]);return{movies:o,onClickRemove:h}},R=()=>{const{movies:n,onClickRemove:s}=q();return t.jsx(b,{carousel:!0,movies:n,onClickRemove:s})},l=[{title:"Избранное",icon:t.jsx(M,{width:24,hanging:24,"aria-hidden":!0}),content:t.jsx(R,{})},{title:"Настройки",icon:t.jsx(g,{width:24,hanging:24,"aria-hidden":!0}),content:t.jsx(k,{})}],w=()=>{const[n,s]=d.useState(l[0]);return t.jsx("section",{className:"my-account",children:t.jsx(p,{children:t.jsxs("div",{className:"my-account__wrapper",children:[t.jsx(_,{level:1,children:"Мой аккаунт"}),t.jsx("nav",{"aria-label":"Навигация по странице аккаунта",children:t.jsx("ul",{className:"my-account__nav-list",children:l.map(e=>t.jsx("li",{children:t.jsxs("button",{className:`my-account__nav-btn ${e===n?"my-account__nav-btn--active":""}`,type:"button",onClick:()=>s(e),children:[e.icon,e.title]})},e.title))})}),n.content]})})})},P=m(()=>t.jsx("main",{children:i.auth.isAuthorized?t.jsx(w,{}):t.jsx(A,{})}));export{P as default};
